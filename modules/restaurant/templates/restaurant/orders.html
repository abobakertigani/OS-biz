<!-- modules/restaurant/templates/restaurant/orders.html -->
<h2>ุงูุทูุจุงุช</h2>
<table border="1" width="100%">
  <tr>
    <th>ุงูุฑูู</th>
    <th>ุงูุทุงููุฉ</th>
    <th>ุงููุฌููุน</th>
    <th>ุงูุญุงูุฉ</th>
    <th>ุงูููุช</th>
    <th>ุงูุฅุฌุฑุงุกุงุช</th>
  </tr>
  {% for row in orders %}
  <tr>
    <td>{{ row.id }}</td>
    <td>{{ row.table_number }}</td>
    <td>{{ '%.2f' % row.total }} ุฑ.ุณ</td>
    <td>{{ {
      'pending': 'ููุฏ ุงูุงูุชุธุงุฑ',
      'cooking': 'ููุทูู',
      'ready': 'ุฌุงูุฒ',
      'served': 'ุชู ุงูุชูุตูู',
      'paid': 'ูุฏููุน'
    }[row.status] }}</td>
    <td>{{ row.timestamp.strftime('%H:%M') }}</td>
    <td>
      <select onchange="updateStatus({{ row.id }}, this.value)" class="status-select">
        <option value="pending" {% if row.status == 'pending' %}selected{% endif %}>ููุฏ ุงูุงูุชุธุงุฑ</option>
        <option value="cooking" {% if row.status == 'cooking' %}selected{% endif %}>ููุทูู</option>
        <option value="ready" {% if row.status == 'ready' %}selected{% endif %}>ุฌุงูุฒ</option>
        <option value="served" {% if row.status == 'served' %}selected{% endif %}>ุชู ุงูุชูุตูู</option>
        <option value="paid" {% if row.status == 'paid' %}selected{% endif %}>ูุฏููุน</option>
      </select>
      <a href="/restaurant/receipt/{{ row.id }}" target="_blank">๐จ๏ธ</a>
    </td>
  </tr>
  {% endfor %}
</table>

<script>
function updateStatus(orderId, status) {
  fetch(`/restaurant/order/${orderId}/status`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ status: status })
  }).then(r => r.json()).then(data => {
    if (!data.success) alert('ูุดู ุงูุชุญุฏูุซ');
  });
}
</script>
